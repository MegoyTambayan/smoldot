<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Imports and exports of the WebAssembly module."><meta name="keywords" content="rust, rustlang, rust-lang, bindings"><title>smoldot_light::ffi::bindings - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled ><script id="default-settings" ></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../../favicon.svg"><link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../../smoldot_light/index.html'><div class='logo-container rust-logo'><img src='../../../rust-logo.png' alt='logo'></div></a><h2 class="location">Module bindings</h2><div class="sidebar-elems"><div class="block items"><ul><li><a href="#functions">Functions</a></li></ul></div><div id="sidebar-vars" data-name="bindings" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input"name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../../index.html">smoldot_light</a>::<wbr><a href="../index.html">ffi</a>::<wbr><a class="mod" href="#">bindings</a><button id="copy-path" onclick="copy_path(this)" title="copy path"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item import" title="Copy item import to clipboard"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../../src/smoldot_light/ffi/bindings.rs.html#18-361" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Imports and exports of the WebAssembly module.</p>
<p>This module contains all the functions that tie together the Rust code and its host (i.e.
the JavaScript code, normally).</p>
<p>The functions found in the <code>extern</code> block are the functions that the Rust code <em>imports</em>, and
need to be implemented on the host side and provided to the WebAssembly virtual machine. The
other functions are functions that the Rust code <em>exports</em>, and can be called by the host.</p>
<h1 id="about-wasi" class="section-header"><a href="#about-wasi">About wasi</a></h1>
<p>The Rust code is expected to be compiled for the <code>wasm32-wasi</code> target, and not just
<code>wasm32-unknown-unknown</code>. The <code>wasi</code> platform is used in order for example to obtain a source
of randomness.</p>
<blockquote>
<p><strong>Note</strong>: While wasi could theoretically also be used in order to obtain the current time,
the Wasi syscall cannot be implemented in pure JavaScript code at the moment, due
to <code>u64</code>s being unusable in Javascript. As such, alternatives are present in the
<code>extern</code> block below.</p>
</blockquote>
<p>Consequently, the exports found in the <code>extern</code> block below are not the only functions that
must be implemented. Several functions required by the Wasi ABI are also used. The best place
to find documentation at the moment is <a href="https://docs.rs/wasi">https://docs.rs/wasi</a>.</p>
<h1 id="about-u32s-and-javascript" class="section-header"><a href="#about-u32s-and-javascript">About <code>u32</code>s and JavaScript</a></h1>
<p>Many functions below accept as parameter or return a <code>u32</code>. In reality, however, the
WebAssembly specification doesn’t mention unsigned integers. Only signed integers (and
floating points) can be passed through the FFI layer.</p>
<p>This isn’t important when the Rust code provides a value that must later be provided back, as
the conversion from the guest to the host is symmetrical to the conversion from the host to
the guest.</p>
<p>It is, however, important when the value needs to be interpreted from the host side, such as
for example the return value of <a href="fn.alloc.html" title="alloc"><code>alloc</code></a>. When using JavaScript as the host, you must do
<code>&gt;&gt;&gt; 0</code> on all the <code>u32</code> values before interpreting them, in order to be certain than they
are treated as unsigned integers by the JavaScript.</p>
</div></details><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="fn" href="fn.add_chain.html" title="smoldot_light::ffi::bindings::add_chain fn">add_chain</a></div><div class="item-right docblock-short"><p>Adds a chain to the client. The client will try to stay connected and synchronize this chain.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.alloc.html" title="smoldot_light::ffi::bindings::alloc fn">alloc</a></div><div class="item-right docblock-short"><p>Allocates a buffer of the given length, with an alignment of 1.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.chain_error_len.html" title="smoldot_light::ffi::bindings::chain_error_len fn">chain_error_len</a></div><div class="item-right docblock-short"><p>Returns the length of the error message stored for this chain.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.chain_error_ptr.html" title="smoldot_light::ffi::bindings::chain_error_ptr fn">chain_error_ptr</a></div><div class="item-right docblock-short"><p>Returns a pointer to the error message stored for this chain. The error message is a UTF-8
string starting at the memory offset returned by this function, and whose length can be
determined by calling <a href="fn.chain_error_len.html" title="chain_error_len"><code>chain_error_len</code></a>.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.chain_is_ok.html" title="smoldot_light::ffi::bindings::chain_is_ok fn">chain_is_ok</a></div><div class="item-right docblock-short"><p>Returns <code>1</code> if creating this chain was successful. Otherwise, returns <code>0</code>.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.connection_close.html" title="smoldot_light::ffi::bindings::connection_close fn">connection_close</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>Close a connection previously initialized with <a href="fn.connection_new.html" title="connection_new"><code>connection_new</code></a>.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.connection_closed.html" title="smoldot_light::ffi::bindings::connection_closed fn">connection_closed</a></div><div class="item-right docblock-short"><p>Can be called at any point by the JavaScript code if the connection switches to the <code>Closed</code>
state.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.connection_message.html" title="smoldot_light::ffi::bindings::connection_message fn">connection_message</a></div><div class="item-right docblock-short"><p>Notify of a message being received on the connection. The connection must be in the <code>Open</code>
state.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.connection_new.html" title="smoldot_light::ffi::bindings::connection_new fn">connection_new</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>Must initialize a new connection that tries to connect to the given multiaddress.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.connection_open.html" title="smoldot_light::ffi::bindings::connection_open fn">connection_open</a></div><div class="item-right docblock-short"><p>Called by the JavaScript code if the connection switches to the <code>Open</code> state. The connection
must be in the <code>Opening</code> state.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.connection_send.html" title="smoldot_light::ffi::bindings::connection_send fn">connection_send</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>Queues data on the given connection. The data is found in the memory of the WebAssembly
virtual machine, at the given pointer. The data must be sent as a binary frame.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.init.html" title="smoldot_light::ffi::bindings::init fn">init</a></div><div class="item-right docblock-short"><p>Initializes the client.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.json_rpc_respond.html" title="smoldot_light::ffi::bindings::json_rpc_respond fn">json_rpc_respond</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>Client is emitting a response to a previous JSON-RPC request sent using <a href="fn.json_rpc_send.html" title="json_rpc_send"><code>json_rpc_send</code></a>.
Also used to send subscriptions notifications.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.json_rpc_send.html" title="smoldot_light::ffi::bindings::json_rpc_send fn">json_rpc_send</a></div><div class="item-right docblock-short"><p>Emit a JSON-RPC request towards the given chain previously added using <a href="fn.add_chain.html" title="add_chain"><code>add_chain</code></a>.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.log.html" title="smoldot_light::ffi::bindings::log fn">log</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>Client is emitting a log entry.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.monotonic_clock_ms.html" title="smoldot_light::ffi::bindings::monotonic_clock_ms fn">monotonic_clock_ms</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>Must return the number of milliseconds that have passed since an arbitrary point in time.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.remove_chain.html" title="smoldot_light::ffi::bindings::remove_chain fn">remove_chain</a></div><div class="item-right docblock-short"><p>Removes a chain previously added using <a href="fn.add_chain.html" title="add_chain"><code>add_chain</code></a>. Instantly unsubscribes all the JSON-RPC
subscriptions and cancels all in-progress requests corresponding to that chain.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.start_timer.html" title="smoldot_light::ffi::bindings::start_timer fn">start_timer</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>After at least <code>milliseconds</code> milliseconds have passed, must call <a href="fn.timer_finished.html" title="timer_finished"><code>timer_finished</code></a> with
the <code>id</code> passed as parameter.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.throw.html" title="smoldot_light::ffi::bindings::throw fn">throw</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>Must throw an exception. The message is a UTF-8 string found in the memory of the
WebAssembly at offset <code>message_ptr</code> and with length <code>message_len</code>.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.timer_finished.html" title="smoldot_light::ffi::bindings::timer_finished fn">timer_finished</a></div><div class="item-right docblock-short"><p>Must be called in response to <a href="fn.start_timer.html" title="start_timer"><code>start_timer</code></a> after the given duration has passed.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.unix_time_ms.html" title="smoldot_light::ffi::bindings::unix_time_ms fn">unix_time_ms</a><a title="unsafe function" href="#"><sup>⚠</sup></a></div><div class="item-right docblock-short"><p>Must return the number of milliseconds that have passed since the UNIX epoch, ignoring
leap seconds.</p>
</div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="smoldot_light" data-search-index-js="../../../search-index.js" data-search-js="../../../search.js"></div>
    <script src="../../../main.js"></script>
</body></html>